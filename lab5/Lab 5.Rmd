---
title: "Lab 5"
author: "Morris Chi"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: yes
    toc_float: yes
    theme: spacelab
    highlight: pygments
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Task 1

```{R}
getwd()
```


# Task 2

Table for 10,000 iterations:

     0      1      2      3      4      5      6      7      8      9     10 
0.0000 0.0001 0.0017 0.0090 0.0355 0.1008 0.1974 0.2694 0.2381 0.1210 0.0270 

Verification with dhyper():
           0            1            2            3            4            5            6            7            8            9 
5.308540e-06 1.276968e-04 1.375584e-03 8.738634e-03 3.625493e-02 1.026445e-01 2.008387e-01 2.681713e-01 2.338625e-01 1.202771e-01 
          10 
2.770383e-02 

```{R}
simulate_binomial <- function(iter, n = 10, p = 0.7) {
  
  successes <- rbinom(iter, size = n, prob = p)
  
  success_counts <- table(factor(successes, levels = 0:n)) / iter

  barplot(success_counts, 
          main = paste("Proportion of Successes (Iterations =", iter, ")"), 
          xlab = "Number of Successes", 
          ylab = "Proportion", 
          col = rainbow(11), 
          border = "black")
  
  return(success_counts)
}

par(mfrow = c(3, 2))  
iter_values <- c(100, 200, 500, 1000, 10000)

results_10000 <- NULL
for (iter in iter_values) {
  result <- simulate_binomial(iter)
  if (iter == 10000) {
    results_10000 <- result
  }
}
par(mfrow = c(1, 1))  

cat("Table for 10,000 iterations:\n")
print(results_10000)

cat("\nVerification with dhyper():\n")
population_size <- 1000  
m <- population_size * 0.7  
n <- population_size * 0.3  
k <- 10  

expected_probabilities_hyper <- sapply(0:10, function(x) dhyper(x, m = m, n = n, k = k))
names(expected_probabilities_hyper) <- 0:10
print(expected_probabilities_hyper)

comparison <- data.frame(
  "Number_of_Successes" = 0:10,
  "Observed_Proportion" = as.numeric(results_10000),
  "Expected_Probability_Hyper" = expected_probabilities_hyper
)
print(comparison)
```

# Task 3


  0      1      2      3      4      5 
0.0043 0.0508 0.2387 0.3951 0.2589 0.0522 

```{R}
marbles <- c(rep(1, 12), rep(0, 8))

sample_without_replacement <- sample(marbles, size = 5, replace = FALSE)
print(sample_without_replacement)

sample_with_replacement <- sample(marbles, size = 5, replace = TRUE)
print(sample_with_replacement)

myhyper=function(iter=100, N=20, r=12, n=5){
  
  sam.mat = matrix(NA, nr=n, nc=iter, byrow=TRUE)
  
  succ = c()
  
  for(i in 1:iter){
    
    sam.mat[,i] = sample(rep(c(1,0), c(r, N-r)), n, replace=FALSE)
    
    succ[i] = sum(sam.mat[,i])
  }
  
  succ.tab = table(factor(succ, levels=0:n))
  
  barplot(succ.tab/(iter), col=rainbow(n+1), 
          main=paste("HYPERGEOMETRIC Simulation (", iter, " Iterations)", sep=""), 
          xlab="Number of successes", ylab="Proportion")
  
  return(succ.tab/iter)
}


iterations = c(100, 200, 500, 1000, 10000)

par(mfrow=c(3, 2))  

for(iter in iterations){
  myhyper(iter=iter, N=20, r=12, n=5)
}


result_10000 = myhyper(iter=10000, N=20, r=12, n=5)
print(result_10000)  

theoretical_probs = dhyper(x=0:5, m=12, n=8, k=5)
names(theoretical_probs) <- 0:5  
print(theoretical_probs)
```

# Task 4

The barplot ends up at roughly around 10% for each number, although random fluctuations happen here and there throughout the 30 graphs. None of them ever go above 15% either, so they're all pretty uniform for the most part.

```{R}
mysample = function(n, iter=10, time=0.5) {
  for (i in 1:iter) {
    
    s = sample(1:10, n, replace=TRUE)
    
    sf = factor(s, levels=1:10)
    
    barplot(table(sf)/n, beside=TRUE, col=rainbow(10), 
            main=paste("Example sample()", "iteration", i, "n =", n), 
            ylim=c(0, 0.2))
    
    Sys.sleep(time)
  }
}

mysample(n=1000, iter=30, time=1)
```

# Task 5

```{R}
choose(8, 4)
1 - ppois(4, lambda = 2)
dnbinom(10, size = 3, prob = 0.4)
pbinom(8, size = 15, prob = 0.4)
```




# Task 6

```{R}

simulate_binomial(iter = 10000, n = 10, p = 0.7)
```


